!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.MapboxClient=t()}}(function(){return function t(e,n,r){function o(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var p=n[s]={exports:{}};e[s][0].call(p.exports,function(t){var n=e[s][1][t];return o(n?n:t)},p,p.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,e){"use strict";var n=t("./make_service"),r=t("xtend/mutable"),o=t("./services/geocoder"),i=t("./services/surface"),s=t("./services/directions"),a=t("./services/matching"),u=n("MapboxClient");r(u.prototype,o.prototype,i.prototype,s.prototype,a.prototype),e.exports=u},{"./make_service":4,"./services/directions":6,"./services/geocoder":7,"./services/matching":8,"./services/surface":9,"xtend/mutable":26}],2:[function(t,e){var n=t("es6-template-strings/compile");e.exports.DEFAULT_ENDPOINT="https://api.mapbox.com",e.exports.API_GEOCODER_FORWARD=n("${endpoint}/v4/geocode/${dataset}/${encodeURIComponent(query)}.json?${query}"),e.exports.API_GEOCODER_REVERSE=n("${endpoint}/v4/geocode/${dataset}/${location.longitude},${location.latitude}.json?${query}"),e.exports.API_DIRECTIONS=n("${endpoint}/v4/directions/${profile}/${encodedWaypoints}.json?${query}"),e.exports.API_SURFACE=n("${endpoint}/v4/surface/${mapid}.json?${query}"),e.exports.API_MATCHING=n("${endpoint}/matching/v4/${profile}.json?${query}")},{"es6-template-strings/compile":14}],3:[function(t,e){"use strict";function n(t){return t.map(function(t){return r("number"==typeof t.latitude&&"number"==typeof t.longitude,"location must be an object with numeric latitude & longitude properties"),t.longitude+","+t.latitude}).join(";")}var r=t("invariant");e.exports=n},{invariant:21}],4:[function(t,e){"use strict";function n(t){function e(e,n){this.name=t,r("string"==typeof e,"accessToken required to instantiate MapboxDirections"),this.accessToken=e,this.endpoint=o.DEFAULT_ENDPOINT,void 0!==n&&(r("object"==typeof n,"options must be an object"),n.endpoint&&(r("string"==typeof n.endpoint,"endpoint must be a string"),this.endpoint=n.endpoint))}return e}var r=t("invariant"),o=t("./constants");e.exports=n},{"./constants":2,invariant:21}],5:[function(t,e){"use strict";function n(t,e,n,s){return i(e,r(n,{endpoint:t.endpoint,query:o.stringify(r(s,{access_token:t.accessToken}))}))}var r=t("xtend"),o=t("querystring"),i=t("es6-template-strings/resolve-to-string");e.exports=n},{"es6-template-strings/resolve-to-string":18,querystring:13,xtend:25}],6:[function(t,e){"use strict";var n=t("invariant"),r=t("superagent"),o=t("../format_points"),i=t("../make_service"),s=t("../make_url"),a=t("../constants"),u=i("MapboxDirections");u.prototype.getDirections=function(t,e,i){void 0===i&&"function"==typeof e&&(i=e,e={}),n(Array.isArray(t),"waypoints must be an array"),n("object"==typeof e,"options must be an object"),n("function"==typeof i,"callback must be a function");var u=o(t),c="mapbox.driving",p=!0,l="geojson",f="text";e.profile&&(n("string"==typeof e.profile,"profile option must be string"),c=e.profile),e.instructions&&(n("string"==typeof e.instructions,"instructions option must be string"),f=e.instructions),e.geometry&&(n("string"==typeof e.geometry,"geometry option must be string"),l=e.geometry);var h=s(this,a.API_DIRECTIONS,{encodedWaypoints:u,profile:c},{instructions:f,geometry:l,alternatives:p});r(h,function(t,e){i(t,e.body)})},e.exports=u},{"../constants":2,"../format_points":3,"../make_service":4,"../make_url":5,invariant:21,superagent:22}],7:[function(t,e){"use strict";var n=t("invariant"),r=t("superagent"),o=t("../make_service"),i=t("../make_url"),s=t("../constants"),a=o("MapboxGeocoder");a.prototype.geocodeForward=function(t,e,o){void 0===o&&"function"==typeof e&&(o=e,e={}),n("string"==typeof t,"query must be a string"),n("object"==typeof e,"options must be an object"),n("function"==typeof o,"callback must be a function");var a={};e.proximity&&(n("number"==typeof e.proximity.latitude&&"number"==typeof e.proximity.longitude,"proximity must be an object with numeric latitude & longitude properties"),a.proximity=e.proximity.longitude+","+e.proximity.latitude);var u="mapbox.places";e.dataset&&(n("string"==typeof e.dataset,"dataset option must be string"),u=e.dataset);var c=i(this,s.API_GEOCODER_FORWARD,{query:t,dataset:u},a);r(c,function(t,e){o(t,e.body)})},a.prototype.geocodeReverse=function(t,e,o){void 0===o&&"function"==typeof e&&(o=e,e={}),n("object"==typeof t,"location must be an object"),n("object"==typeof e,"options must be an object"),n("function"==typeof o,"callback must be a function"),n("number"==typeof t.latitude&&"number"==typeof t.longitude,"location must be an object with numeric latitude & longitude properties");var a="mapbox.places";e.dataset&&(n("string"==typeof e.dataset,"dataset option must be string"),a=e.dataset);var u=i(this,s.API_GEOCODER_REVERSE,{location:t,dataset:a},{});r(u,function(t,e){o(t,e.body)})},e.exports=a},{"../constants":2,"../make_service":4,"../make_url":5,invariant:21,superagent:22}],8:[function(t,e){"use strict";var n=t("invariant"),r=t("superagent"),o=t("geojsonhint/object"),i=t("../make_service"),s=t("../make_url"),a=t("../constants"),u=i("MapboxMatching");u.prototype.matching=function(t,e,i){void 0===i&&"function"==typeof e&&(i=e,e={}),n(0===o.hint(t).length,"trace must be valid GeoJSON"),n("object"==typeof e,"options must be an object"),n("function"==typeof i,"callback must be a function");var u="mapbox.driving",c=4,p="geojson";void 0!==e.gps_precision&&(n("number"==typeof e.gps_precision,"gps_precision must be a number"),c=e.gps_precision),e.profile&&(n("string"==typeof e.profile,"profile option must be string"),u=e.profile),e.geometry&&(n("string"==typeof e.geometry,"geometry option must be string"),p=e.geometry);var l=s(this,a.API_MATCHING,{profile:u},{geometry:p,gps_precision:c});r.post(l).send(t).end(function(t,e){i(t,e.body)})},e.exports=u},{"../constants":2,"../make_service":4,"../make_url":5,"geojsonhint/object":20,invariant:21,superagent:22}],9:[function(t,e){"use strict";var n=t("invariant"),r=t("superagent"),o=t("../format_points"),i=t("../make_service"),s=t("../make_url"),a=t("../constants"),u=i("MapboxSurface");u.prototype.surface=function(t,e,i,u,c,p){void 0===p&&"function"==typeof c&&(p=c,c={}),n("string"==typeof t,"mapid must be a string"),n("string"==typeof e,"layer must be a string"),n(Array.isArray(i),"fields must be an array of strings"),n(Array.isArray(u)||"string"==typeof u,"path must be an array of objects or a string"),n("object"==typeof c,"options must be an object"),n("function"==typeof p,"callback must be a function");var l=!0,f=!1;void 0!==c.interpolate&&(n("boolean"==typeof c.interpolate,"interpolate must be a boolean"),l=c.interpolate),void 0!==c.geojson&&(n("boolean"==typeof c.geojson,"geojson option must be boolean"),f=c.geojson);var h={geojson:f,layer:e,fields:i.join(","),interpolate:l};Array.isArray(u)?h.points=o(u):h.encoded_polyline=u,void 0!==c.zoom&&(n("number"==typeof c.zoom,"zoom must be a number"),h.z=c.zoom);var d=s(this,a.API_SURFACE,{mapid:t},h);r(d,function(t,e){p(t,e.body)})},e.exports=u},{"../constants":2,"../format_points":3,"../make_service":4,"../make_url":5,invariant:21,superagent:22}],10:[function(t,e){function n(){c=!1,s.length?u=s.concat(u):p=-1,u.length&&r()}function r(){if(!c){var t=setTimeout(n);c=!0;for(var e=u.length;e;){for(s=u,u=[];++p<e;)s[p].run();p=-1,e=u.length}s=null,c=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function i(){}var s,a=e.exports={},u=[],c=!1,p=-1;a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new o(t,e)),1!==u.length||c||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=i,a.addListener=i,a.once=i,a.off=i,a.removeListener=i,a.removeAllListeners=i,a.emit=i,a.binding=function(){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],11:[function(t,e){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,o,i){e=e||"&",o=o||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var p=0;c>p;++p){var l,f,h,d,y=t[p].replace(a,"%20"),m=y.indexOf(o);m>=0?(l=y.substr(0,m),f=y.substr(m+1)):(l=y,f=""),h=decodeURIComponent(l),d=decodeURIComponent(f),n(s,h)?r(s[h])?s[h].push(d):s[h]=[s[h],d]:s[h]=d}return s};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],12:[function(t,e){"use strict";function n(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,s,a){return e=e||"&",s=s||"=",null===t&&(t=void 0),"object"==typeof t?n(i(t),function(i){var a=encodeURIComponent(r(i))+s;return o(t[i])?n(t[i],function(t){return a+encodeURIComponent(r(t))}).join(e):a+encodeURIComponent(r(t[i]))}).join(e):a?encodeURIComponent(r(a))+s+encodeURIComponent(r(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],13:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":11,"./encode":12}],14:[function(t,e){"use strict";var n,r,o,i,s,a,u,c;i=function(t){return"\\"===t?s:"$"===t?a:(n+=t,i)},s=function(t){return"\\"!==t&&"$"!==t&&(n+="\\"),n+=t,i},a=function(t){return"{"===t?(r.push(n),n="",u):"$"===t?(n+="$",a):(n+="$"+t,i)},u=function(t){return"\\"===t?c:"}"===t?(o.push(n),n="",i):(n+=t,u)},c=function(t){return"\\"!==t&&"}"!==t&&(n+="\\"),n+=t,u},e.exports=function(t){var e,p,l,f;for(n="",r=[],o=[],t=String(t),e=t.length,p=i,l=0;e>l;++l)p=p(t[l]);return p===i?r.push(n):p===s?r.push(n+"\\"):p===a?r.push(n+"$"):p===u?r[r.length-1]+="${"+n:p===c&&(r[r.length-1]+="${"+n+"\\"),f={literals:r,substitutions:o},r=o=null,f}},{}],15:[function(t,e){"use strict";var n=Array.prototype.forEach,r=Object.create,o=function(t,e){var n;for(n in t)e[n]=t[n]};e.exports=function(){var t=r(null);return n.call(arguments,function(e){null!=e&&o(Object(e),t)}),t}},{}],16:[function(t,e){"use strict";e.exports=function(t){if(null==t)throw new TypeError("Cannot use null or undefined");return t}},{}],17:[function(t,e){"use strict";var n=Array.prototype.reduce;e.exports=function(t){var e=arguments;return n.call(t,function(t,n,r){return t+String(e[r])+n})}},{}],18:[function(t,e){"use strict";var n=t("./resolve"),r=t("./passthru");e.exports=function(t,e){return r.apply(null,n(t,e))}},{"./passthru":17,"./resolve":19}],19:[function(t,e){"use strict";var n=t("es5-ext/object/valid-value"),r=t("es5-ext/object/normalize-options"),o=Array.prototype.map,i=Object.keys,s=JSON.stringify;e.exports=function(t,e){var a,u,c,p;n(t)&&n(t.literals)&&n(t.substitutions),e=r(e),a=i(e),c=a.join(", "),p=a.map(function(t){return e[t]});try{u=new Function(c,"return ["+o.call(t.substitutions,function(t){return t?"("+t+")":"''"}).join(", ")+"];").apply(null,p)}catch(l){throw a.forEach(function(e,n){var r,o=t.substitutions[n],i="return "+(o?"("+o+")":"''");try{r=new Function(c,i)}catch(a){throw new TypeError("Unable to compile expression:\n	args: "+s(c)+"\n	body: "+s(i)+"\n	error: "+a.stack)}try{r.apply(null,p)}catch(a){throw new TypeError("Unable to resolve expression:\n	args: "+s(c)+"\n	body: "+s(i)+"\n	error: "+a.stack)}}),l}return[t.literals].concat(u)}},{"es5-ext/object/normalize-options":15,"es5-ext/object/valid-value":16}],20:[function(t,e){function n(t){function e(t){t.type?b[t.type]?t&&b[t.type](t):g.push({message:"The type "+t.type+" is unknown",line:t.__line__}):g.push({message:"The type property is required and was not found",line:t.__line__})}function n(t,e){return t.every(function(t){return null!==t&&typeof t===e})}function r(t,e,n){if("undefined"==typeof t[e])return g.push({message:'"'+e+'" property required',line:t.__line__});if("array"===n){if(!Array.isArray(t[e]))return g.push({message:'"'+e+'" property should be an array, but is an '+typeof t[e]+" instead",line:t.__line__})}else if(n&&typeof t[e]!==n)return g.push({message:'"'+e+'" property should be '+n+", but is an "+typeof t[e]+" instead",line:t.__line__})}function o(t){if(a(t),u(t),!r(t,"features","array")){if(!n(t.features,"object"))return g.push({message:"Every feature must be an object",line:t.__line__});t.features.forEach(m)}}function i(t,e){return Array.isArray(t)?t.length<2?g.push({message:"position must have 2 or more elements",line:t.__line__||e}):n(t,"number")?void 0:g.push({message:"each element in a position must be a number",line:t.__line__||e}):g.push({message:"position should be an array, is a "+typeof t+" instead",line:t.__line__||e})}function s(t,e,n,r){if(void 0===r&&void 0!==t.__line__&&(r=t.__line__),0===n)return i(t,r);if(1===n&&e)if("LinearRing"===e){if(!Array.isArray(t[t.length-1]))return g.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:r});t.length<4&&g.push({message:"a LinearRing of coordinates needs to have four or more positions",line:r}),!t.length||t[t.length-1].length===t[0].length&&t[t.length-1].every(function(e,n){return t[0][n]===e})||g.push({message:"the first and last positions in a LinearRing of coordinates must be the same",line:r})}else"Line"===e&&t.length<2&&g.push({message:"a line needs to have two or more coordinates to be valid",line:r});t.forEach(function(t){s(t,e,n-1,t.__line__||r)})}function a(t){if(t.crs)if("object"==typeof t.crs){var e=r(t.crs,"type","string"),n=r(t.crs,"properties","object");e||n||("name"===t.crs.type?r(t.crs.properties,"name","string"):"link"===t.crs.type&&r(t.crs.properties,"href","string"))}else g.push({message:"the value of the crs property must be an object, not a "+typeof t.crs,line:t.__line__})}function u(t){if(t.bbox)if(Array.isArray(t.bbox)){if(!n(t.bbox,"number"))return g.push({message:"each element in a bbox property must be a number",line:t.bbox.__line__})}else g.push({message:"bbox property must be an array of numbers, but is a "+typeof t.bbox,line:t.__line__})}function c(t){a(t),u(t),r(t,"coordinates","array")||i(t.coordinates)}function p(t){a(t),u(t),r(t,"coordinates","array")||s(t.coordinates,"LinearRing",2)}function l(t){a(t),u(t),r(t,"coordinates","array")||s(t.coordinates,"LinearRing",3)}function f(t){a(t),u(t),r(t,"coordinates","array")||s(t.coordinates,"Line",1)}function h(t){a(t),u(t),r(t,"coordinates","array")||s(t.coordinates,"Line",2)}function d(t){a(t),u(t),r(t,"coordinates","array")||s(t.coordinates,"",1)}function y(t){a(t),u(t),r(t,"geometries","array")||t.geometries.forEach(function(t){t&&e(t)})}function m(t){a(t),u(t),void 0!==t.id&&"string"!=typeof t.id&&"number"!=typeof t.id&&g.push({message:'Feature "id" property must have a string or number value',line:t.__line__}),"Feature"!==t.type&&g.push({message:"GeoJSON features must have a type=feature property",line:t.__line__}),r(t,"properties","object"),r(t,"geometry","object")||t.geometry&&e(t.geometry)}var g=[],b={Point:c,Feature:m,MultiPoint:d,LineString:f,MultiLineString:h,FeatureCollection:o,GeometryCollection:y,Polygon:p,MultiPolygon:l};return"object"!=typeof t||null===t||void 0===t?(g.push({message:"The root of a GeoJSON object must be an object.",line:0}),g):(e(t),g.forEach(function(t){t.hasOwnProperty("line")&&void 0===t.line&&delete t.line}),g)}e.exports.hint=n},{}],21:[function(t,e){(function(t){"use strict";var n=function(e,n,r,o,i,s,a,u){if("production"!==t.env.NODE_ENV&&void 0===n)throw new Error("invariant requires an error message argument");if(!e){var c;if(void 0===n)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var p=[r,o,i,s,a,u],l=0;c=new Error("Invariant Violation: "+n.replace(/%s/g,function(){return p[l++]}))}throw c.framesToPop=1,c}};e.exports=n}).call(this,t("_process"))},{_process:10}],22:[function(t,e){function n(){}function r(t){var e={}.toString.call(t);switch(e){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function o(t){return t===Object(t)}function i(t){if(!o(t))return t;var e=[];for(var n in t)null!=t[n]&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")}function s(t){for(var e,n,r={},o=t.split("&"),i=0,s=o.length;s>i;++i)n=o[i],e=n.split("="),r[decodeURIComponent(e[0])]=decodeURIComponent(e[1]);return r}function a(t){var e,n,r,o,i=t.split(/\r?\n/),s={};i.pop();for(var a=0,u=i.length;u>a;++a)n=i[a],e=n.indexOf(":"),r=n.slice(0,e).toLowerCase(),o=m(n.slice(e+1)),s[r]=o;return s}function u(t){return t.split(/ *; */).shift()}function c(t){return d(t.split(/ *; */),function(t,e){var n=e.split(/ *= */),r=n.shift(),o=n.shift();return r&&o&&(t[r]=o),t},{})}function p(t,e){e=e||{},this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this.setStatusProperties(this.xhr.status),this.header=this.headers=a(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text?this.text:this.xhr.response):null}function l(t,e){var n=this;h.call(this),this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var t=null,e=null;try{e=new p(n)}catch(r){return t=new Error("Parser is unable to parse the response"),t.parse=!0,t.original=r,n.callback(t)}if(n.emit("response",e),t)return n.callback(t,e);if(e.status>=200&&e.status<300)return n.callback(t,e);var o=new Error(e.statusText||"Unsuccessful HTTP response");o.original=t,o.response=e,o.status=e.status,n.callback(t||o,e)})}function f(t,e){return"function"==typeof e?new l("GET",t).end(e):1==arguments.length?new l("GET",t):new l(t,e)}var h=t("emitter"),d=t("reduce"),y="undefined"==typeof window?this||self:window;f.getXHR=function(){if(!(!y.XMLHttpRequest||y.location&&"file:"==y.location.protocol&&y.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1};var m="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};f.serializeObject=i,f.parseString=s,f.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},f.serialize={"application/x-www-form-urlencoded":i,"application/json":JSON.stringify},f.parse={"application/x-www-form-urlencoded":s,"application/json":JSON.parse},p.prototype.get=function(t){return this.header[t.toLowerCase()]},p.prototype.setHeaderProperties=function(){var t=this.header["content-type"]||"";this.type=u(t);var e=c(t);for(var n in e)this[n]=e[n]},p.prototype.parseBody=function(t){var e=f.parse[this.type];return e&&t&&(t.length||t instanceof Object)?e(t):null},p.prototype.setStatusProperties=function(t){1223===t&&(t=204);var e=t/100|0;this.status=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.clientError=4==e,this.serverError=5==e,this.error=4==e||5==e?this.toError():!1,this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.notFound=404==t,this.forbidden=403==t},p.prototype.toError=function(){var t=this.req,e=t.method,n=t.url,r="cannot "+e+" "+n+" ("+this.status+")",o=new Error(r);return o.status=this.status,o.method=e,o.url=n,o},f.Response=p,h(l.prototype),l.prototype.use=function(t){return t(this),this},l.prototype.timeout=function(t){return this._timeout=t,this},l.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},l.prototype.abort=function(){return this.aborted?void 0:(this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this)},l.prototype.set=function(t,e){if(o(t)){for(var n in t)this.set(n,t[n]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},l.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},l.prototype.getHeader=function(t){return this._header[t.toLowerCase()]},l.prototype.type=function(t){return this.set("Content-Type",f.types[t]||t),this},l.prototype.accept=function(t){return this.set("Accept",f.types[t]||t),this},l.prototype.auth=function(t,e){var n=btoa(t+":"+e);return this.set("Authorization","Basic "+n),this},l.prototype.query=function(t){return"string"!=typeof t&&(t=i(t)),t&&this._query.push(t),this},l.prototype.field=function(t,e){return this._formData||(this._formData=new y.FormData),this._formData.append(t,e),this},l.prototype.attach=function(t,e,n){return this._formData||(this._formData=new y.FormData),this._formData.append(t,e,n),this},l.prototype.send=function(t){var e=o(t),n=this.getHeader("Content-Type");if(e&&o(this._data))for(var i in t)this._data[i]=t[i];else"string"==typeof t?(n||this.type("form"),n=this.getHeader("Content-Type"),this._data="application/x-www-form-urlencoded"==n?this._data?this._data+"&"+t:t:(this._data||"")+t):this._data=t;return!e||r(t)?this:(n||this.type("json"),this)},l.prototype.callback=function(t,e){var n=this._callback;this.clearTimeout(),n(t,e)},l.prototype.crossDomainError=function(){var t=new Error("Origin is not allowed by Access-Control-Allow-Origin");t.crossDomain=!0,this.callback(t)},l.prototype.timeoutError=function(){var t=this._timeout,e=new Error("timeout of "+t+"ms exceeded");e.timeout=t,this.callback(e)},l.prototype.withCredentials=function(){return this._withCredentials=!0,this},l.prototype.end=function(t){var e=this,o=this.xhr=f.getXHR(),i=this._query.join("&"),s=this._timeout,a=this._formData||this._data;this._callback=t||n,o.onreadystatechange=function(){if(4==o.readyState){var t;try{t=o.status}catch(n){t=0}if(0==t){if(e.timedout)return e.timeoutError();if(e.aborted)return;return e.crossDomainError()}e.emit("end")}};var u=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.emit("progress",t)};this.hasListeners("progress")&&(o.onprogress=u);try{o.upload&&this.hasListeners("progress")&&(o.upload.onprogress=u)}catch(c){}if(s&&!this._timer&&(this._timer=setTimeout(function(){e.timedout=!0,e.abort()},s)),i&&(i=f.serializeObject(i),this.url+=~this.url.indexOf("?")?"&"+i:"?"+i),o.open(this.method,this.url,!0),this._withCredentials&&(o.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof a&&!r(a)){var p=f.serialize[this.getHeader("Content-Type")];p&&(a=p(a))}for(var l in this.header)null!=this.header[l]&&o.setRequestHeader(l,this.header[l]);return this.emit("request",this),o.send(a),this},f.Request=l,f.get=function(t,e,n){var r=f("GET",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},f.head=function(t,e,n){var r=f("HEAD",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},f.del=function(t,e){var n=f("DELETE",t);return e&&n.end(e),n},f.patch=function(t,e,n){var r=f("PATCH",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},f.post=function(t,e,n){var r=f("POST",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},f.put=function(t,e,n){var r=f("PUT",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},e.exports=f},{emitter:23,reduce:24}],23:[function(t,e){function n(t){return t?r(t):void 0}function r(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},n.prototype.once=function(t,e){function n(){r.off(t,n),e.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},n.fn=e,this.on(t,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[t];if(!n)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===e||r.fn===e){n.splice(o,1);break}return this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks[t];if(n){n=n.slice(0);for(var r=0,o=n.length;o>r;++r)n[r].apply(this,e)}return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],24:[function(t,e){e.exports=function(t,e,n){for(var r=0,o=t.length,i=3==arguments.length?n:t[r++];o>r;)i=e.call(null,i,t[r],++r,t);return i}},{}],25:[function(t,e){function n(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}e.exports=n},{}],26:[function(t,e){function n(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}e.exports=n},{}]},{},[1])(1)});